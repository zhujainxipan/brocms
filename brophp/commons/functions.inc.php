<?php
/** ******************************************************************************
 * brophp.com æ¡†æ¶å†…ç½®çš„å‡½æ•°åº“æ–‡ä»¶ï¼Œå£°æ˜åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­çš„å‡½æ•°å¯ä»¥ä»»ä½•ä½ç½®ç›´æ¥è°ƒç”¨ã€‚ *
 * *******************************************************************************
 * è®¸å¯å£°æ˜ï¼šä¸“ä¸ºã€Šç»†è¯´PHPã€‹è¯»è€…åŠLAMPå…„å¼Ÿè¿å­¦å‘˜æä¾›çš„â€œå­¦ä¹ å‹â€è¶…è½»é‡çº§phpæ¡†æ¶ã€‚*
 * *******************************************************************************
 * ç‰ˆæƒæ‰€æœ‰ (C) 2011-2013 åŒ—äº¬æ˜“ç¬¬ä¼˜æ•™è‚²å’¨è¯¢æœ‰é™å…¬å¸ï¼Œå¹¶ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚           *
 * ç½‘ç«™åœ°å€: http://www.lampbrother.net (LAMPå…„å¼Ÿè¿)                             *
 * *******************************************************************************
 * $Author: é«˜æ´›å³° (skygao@lampbrother.net) $                                    *
 * $Date: 2011-07-18 10:00:00 $                                                  * 
 * ******************************************************************************/

	/**
	 * è¾“å‡ºå„ç§ç±»å‹çš„æ•°æ®ï¼Œè°ƒè¯•ç¨‹åºæ—¶æ‰“å°æ•°æ®ä½¿ç”¨ã€‚
	 * @param	mixed	å‚æ•°ï¼šå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªä»»æ„å˜é‡æˆ–å€¼
	 */
	function p(){
		$args=func_get_args();  //è·å–å¤šä¸ªå‚æ•°
		if(count($args)<1){
			Debug::addmsg("<font color='red'>å¿…é¡»ä¸ºp()å‡½æ•°æä¾›å‚æ•°!");
			return;
		}	

		echo '<div style="width:100%;text-align:left"><pre>';
		//å¤šä¸ªå‚æ•°å¾ªç¯è¾“å‡º
		foreach($args as $arg){
			if(is_array($arg)){  
				print_r($arg);
				echo '<br>';
			}else if(is_string($arg)){
				echo $arg.'<br>';
			}else{
				var_dump($arg);
				echo '<br>';
			}
		}
		echo '</pre></div>';	
	}
	/**
	 * åˆ›å»ºModelsä¸­çš„æ•°æ®åº“æ“ä½œå¯¹è±¡
	 *  @param	string	$className	ç±»åæˆ–è¡¨å
	 *  @param	string	$app	 åº”ç”¨å,è®¿é—®å…¶ä»–åº”ç”¨çš„Model
	 *  @return	object	æ•°æ®åº“è¿æ¥å¯¹è±¡
	 */
	function D($className=null,$app=""){
		$db=null;	
		//å¦‚æœæ²¡æœ‰ä¼ è¡¨åæˆ–ç±»åï¼Œåˆ™ç›´æ¥åˆ›å»ºDBå¯¹è±¡ï¼Œä½†ä¸èƒ½å¯¹è¡¨è¿›è¡Œæ“ä½œ
		if(is_null($className)){
			$class="D".DRIVER;

			$db=new $class;
		}else{
			$className=strtolower($className);
			$model=Structure::model($className, $app);	
			$model=new $model();

			//å¦‚æœè¡¨ç»“æ„ä¸å­˜åœ¨ï¼Œåˆ™è·å–è¡¨ç»“æ„
			$model->setTable($className);		
		

			$db=$model;
		}
		if($app=="")
			$db->path=APP_PATH;
		else
			$db->path=PROJECT_PATH.strtolower($app).'/';
		return $db;
	}
	/**
	 * æ–‡ä»¶å°ºå¯¸è½¬æ¢ï¼Œå°†å¤§å°å°†å­—èŠ‚è½¬ä¸ºå„ç§å•ä½å¤§å°
	 * @param	int	$bytes	å­—èŠ‚å¤§å°
	 * @return	string	è½¬æ¢åå¸¦å•ä½çš„å¤§å°
	 */
	function tosize($bytes) {       	 	     //è‡ªå®šä¹‰ä¸€ä¸ªæ–‡ä»¶å¤§å°å•ä½è½¬æ¢å‡½æ•°
		if ($bytes >= pow(2,40)) {      		     //å¦‚æœæä¾›çš„å­—èŠ‚æ•°å¤§äºç­‰äº2çš„40æ¬¡æ–¹ï¼Œåˆ™æ¡ä»¶æˆç«‹
			$return = round($bytes / pow(1024,4), 2);    //å°†å­—èŠ‚å¤§å°è½¬æ¢ä¸ºåŒç­‰çš„Tå¤§å°
			$suffix = "TB";                        	     //å•ä½ä¸ºTB
		} elseif ($bytes >= pow(2,30)) {  		     //å¦‚æœæä¾›çš„å­—èŠ‚æ•°å¤§äºç­‰äº2çš„30æ¬¡æ–¹ï¼Œåˆ™æ¡ä»¶æˆç«‹
			$return = round($bytes / pow(1024,3), 2);    //å°†å­—èŠ‚å¤§å°è½¬æ¢ä¸ºåŒç­‰çš„Gå¤§å°
			$suffix = "GB";                              //å•ä½ä¸ºGB
		} elseif ($bytes >= pow(2,20)) {  		     //å¦‚æœæä¾›çš„å­—èŠ‚æ•°å¤§äºç­‰äº2çš„20æ¬¡æ–¹ï¼Œåˆ™æ¡ä»¶æˆç«‹
			$return = round($bytes / pow(1024,2), 2);    //å°†å­—èŠ‚å¤§å°è½¬æ¢ä¸ºåŒç­‰çš„Må¤§å°
			$suffix = "MB";                              //å•ä½ä¸ºMB
		} elseif ($bytes >= pow(2,10)) {  		     //å¦‚æœæä¾›çš„å­—èŠ‚æ•°å¤§äºç­‰äº2çš„10æ¬¡æ–¹ï¼Œåˆ™æ¡ä»¶æˆç«ç«
			$return = round($bytes / pow(1024,1), 2);    //å°†å­—èŠ‚å¤§å°è½¬æ¢ä¸ºåŒç­‰çš„Kå¤§å°
			$suffix = "KB";                              //å•ä½ä¸ºKB
		} else {                     			     //å¦åˆ™æä¾›çš„å­—èŠ‚æ•°å°äº2çš„10æ¬¡æ–¹ï¼Œåˆ™æ¡ä»¶æˆç«‹
			$return = $bytes;                            //å­—èŠ‚å¤§å°å•ä½ä¸å˜
			$suffix = "Byte";                            //å•ä½ä¸ºByte
		}
		return $return ." " . $suffix;                       //è¿”å›åˆé€‚çš„æ–‡ä»¶å¤§å°å’Œå•ä½
	}
	/**
	 * å…³é—­è°ƒè¯•æ¨¡å¼
	 * @param	bool	$falg	è°ƒå¼æ¨¡å¼çš„å…³é—­å¼€å…³
	 */
	function debug($falg=0){
		$GLOBALS["debug"]=$falg;
	}

